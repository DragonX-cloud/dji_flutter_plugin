<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, user-scalable=no">
  <meta name="generator" content="made with love by dartdoc 4.1.0">
  <meta name="description" content="dji API docs, for the Dart programming language.">
  <title>dji - Dart API docs</title>


  
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,300;0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
  <link rel="stylesheet" href="static-assets/github.css?v1">
  <link rel="stylesheet" href="static-assets/styles.css?v1">
  <link rel="icon" href="static-assets/favicon.png?v1">

  
</head>


<body data-base-href=""
      data-using-base-href="false">

<div id="overlay-under-drawer"></div>

<header id="title">
  <button id="sidenav-left-toggle" type="button">&nbsp;</button>
  <ol class="breadcrumbs gt-separated dark hidden-xs">
    <li><a href="https://dragonx.cloud/">dji package</a></li>
  </ol>
  <div class="self-name">dji</div>
  <form class="search navbar-right" role="search">
    <input type="text" id="search-box" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<main>


  <div id="dartdoc-main-content" class="main-content">
      
<section class="desc markdown">
  <h1 id="dji">dji</h1>
<h2 id="a-flutter-plugin-for-dji-sdk">A FLUTTER PLUGIN FOR DJI SDK</h2>
<p>This open source project intends to bring the DJI SDK functionalities into Flutter.</p>
<p>We strongly advice to first read at least the DJI Hardware Introduction:<br>
<a href="https://developer.dji.com/document/52b7f3b9-a773-47b3-b9e5-71c7a3190736">https://developer.dji.com/document/52b7f3b9-a773-47b3-b9e5-71c7a3190736</a><br>
And the DJI Mobile SDK Introduction:<br>
<a href="https://developer.dji.com/document/4cd08995-3952-4db6-ab6e-bc3a754da153">https://developer.dji.com/document/4cd08995-3952-4db6-ab6e-bc3a754da153</a><br>
To get familiar with the basic terminology and concepts.</p>
<p><strong>// WORK IN PROGRESS</strong><br>
This plugin is still in-progress.<br>
It currently supports the following features:</p>
<ul>
<li>Register</li>
<li>Connect / Disconnect</li>
<li>Takeoff</li>
<li>Land</li>
<li>Timeline:
<ul>
<li>Takeoff</li>
<li>Land</li>
<li>Take a picture</li>
<li>Start/Stop video</li>
<li>Waypoints Mission</li>
</ul>
</li>
</ul>
<p>Streaming or downloading the video/images is not yet supported, but in progress.</p>
<h2 id="setup">SETUP</h2>
<p>Before you start using the DJI Flutter plugin, you must first perform some initial setup and configurations as required by DJI SDK.</p>
<h3 id="getting-dji-developer-credentials">Getting DJI Developer Credentials</h3>
<p>In order to use DJI SDK, you need to become a DJI Developer:
<a href="https://developer.dji.com/">https://developer.dji.com/</a></p>
<p>Once registered and signed-in, you need to create two new apps - one for Android and one for iOS.<br>
Make sure you fill-in your correct App package-name as defined when you created your Flutter project.</p>
<p>Once your Apps are registered on DJI Developer Portal, you have an "App Key" for each one.
This App Key should be included in your Android Manifest XML and iOS info.plist as described later on.</p>
<p>You may search the Github /example folder to locate the App Keys that were used in the example project:<br>
<code>cloud.dragonx.plugin.flutter.djiExample</code> on iOS is using <code>b5245cf16f4b43ed90d436ba</code><br>
<code>cloud.dragonx.plugin.flutter.djiExample</code> on Android is using <code>23acf68f822be3f065e6f538</code></p>
<h5 id="note">Note</h5>
<p>The best way to create a Flutter project with your desired package-name is by command line and the --org argument:</p>
<pre class="language-dart"><code>flutter create --org com.yourdomain yourAppName  
</code></pre>
<p><a href="https://flutteragency.com/create-a-new-project-in-flutter/">https://flutteragency.com/create-a-new-project-in-flutter/</a></p>
<p><strong>For a tip in regards to package names - please <a href="#a-tip-in-regards-to-package-names">read this</a>.</strong></p>
<h3 id="adding-the-dji-sdk-to-your-flutter-ios-project">Adding the DJI SDK to your Flutter iOS Project</h3>
<p>Follow this tutotial:<br>
<a href="https://developer.dji.com/document/76942407-070b-4542-8042-204cfb169168">https://developer.dji.com/document/76942407-070b-4542-8042-204cfb169168</a></p>
<h5 id="important-notes">Important Notes</h5>
<p>Open your Flutter iOS Workspace in Xcode, and click the "info" tab (in between the Resource Tags and the Build Settings).
Under the "Custom iOS Target Properties" section - right click on the last row and choose "Add Row" and add the following:</p>
<p>Add "Supported external accessory protocols" with 3 items:</p>
<ul>
<li>Item0 = com.dji.common</li>
<li>Item1 = com.dji.protocol</li>
<li>Item2 = com.dji.video</li>
</ul>
<p>Add the "App Transport Security Settings" key, with "Allow Arbitrary Loads" of values YES.</p>
<p><strong>Create a <code>DJISDKAppKey</code> key in the info.plist file and paste the App Key string into its string value (right click on any of the existing rows or below them and add a new row).</strong></p>
<p>Add the key <code>NSBluetoothAlwaysUsageDescription</code> to the Info.plist with a description explaining that the DJI Drone requires bluetooth connection.</p>
<p>Note:
Don't forget to run <code>pod install</code> from the ./ios folder of your project, and verify that you're able to compile your project via Xcode (before compiling via Flutter).</p>
<h3 id="adding-the-dji-sdk-to-your-flutter-android-kotlin-project">Adding the DJI SDK to your Flutter Android (Kotlin) Project</h3>
<p>Follow this tutotial:<br>
<a href="https://github.com/DJI-Mobile-SDK-Tutorials/Android-ImportAndActivateSDKInAndroidStudio">https://github.com/DJI-Mobile-SDK-Tutorials/Android-ImportAndActivateSDKInAndroidStudio</a></p>
<p><strong>Make sure your add your DJI Android App Key in the /androind/app/src/main/AndroidManifest.xml file like so:</strong></p>
<pre class="language-dart"><code>&lt;meta-data android:name="com.dji.sdk.API_KEY" android:value="23acf68f822be3f065e6f538" /&gt;
</code></pre>
<h5 id="important-notes-2">Important Notes</h5>
<p>In build.gradle:</p>
<ul>
<li>Set the Target SDK to 30 (and not 31, as it caused issues with the Manifest merge)</li>
<li><strong><code> ! </code> IMPORTANT</strong> For DJI SDK to work properly the minSDK must be set to 19 (otherwise the helper.install doesn't work).</li>
<li>Due to the minSDK 19 - MultiDex MUST be enabled.</li>
</ul>
<h5 id="dji-android-samples-and-tutorials">DJI Android Samples and Tutorials</h5>
<p>If you wish to learn and experiment with the DJI SDK on Android - here are some useful links and tips.</p>
<p>DJI Android Sample App:<br>
<a href="https://github.com/dji-sdk/Mobile-SDK-Android/tree/master/Sample%2520Code">https://github.com/dji-sdk/Mobile-SDK-Android/tree/master/Sample%20Code</a></p>
<p>Another useful demo app - Android Simulator Demo:<br>
<a href="https://github.com/DJI-Mobile-SDK-Tutorials/Android-SimulatorDemo/blob/master/DJISimulatorDemo/app/src/main/java/com/dji/simulatorDemo/MainActivity.java">https://github.com/DJI-Mobile-SDK-Tutorials/Android-SimulatorDemo/blob/master/DJISimulatorDemo/app/src/main/java/com/dji/simulatorDemo/MainActivity.java</a></p>
<p>The DJI Tutorial can be found here below, but please note you must rely on the above Github Repo as reference, because many of the code examples inside this tutorial are outdated:
<a href="https://developer.dji.com/mobile-sdk/documentation/application-development-workflow/workflow-integrate.html#import-maven-dependency">https://developer.dji.com/mobile-sdk/documentation/application-development-workflow/workflow-integrate.html#import-maven-dependency</a></p>
<p>If you're trying to run the DJI sample, then note that in MainActivity.kt - Need to remove "import android.R".</p>
<h3 id="preparing-your-development-environment--simulator">Preparing your Development Environment &amp; Simulator</h3>
<ul>
<li>Your DJI Drone should be connected by a USB to your computer.</li>
<li>You should install the DJI Assistance &gt; connect to the Drone &gt; open and start the simulator.</li>
<li>The remote control should be connected by cable to your development mobile device.</li>
<li>The mobile device should be connected to the same Wifi as your computer.
<ul>
<li>For iOS Xcode - this should be sufficient to allow Xcode to install and debug your app on the mobile device.</li>
<li>For Android - use <a href="#debugging-android-over-wifi">these instructions</a> to allow Wifi installation and debugging.</li>
</ul>
</li>
</ul>
<h2 id="usage">USAGE</h2>
<p>Once you have completed the above setup, you are ready to start using the DJI Flutter plugin in your Flutter code.</p>
<p>For general knowledge, the <code>Dji</code> class is using the <code>DjiHostApi</code> class to trigger methods on the "host platform" (the native part).
The <code>DjiFlutterApi</code> class is responsible for allowing the host to trigger methods on the Flutter side.</p>
<p>A full example can be found in the example/lib/example.dart file:<br>
<a href="https://github.com/DragonX-cloud/dji_flutter_plugin/blob/main/example/lib/example.dart">https://github.com/DragonX-cloud/dji_flutter_plugin/blob/main/example/lib/example.dart</a></p>
<h3 id="getting-continuous-updates-of-the-drone-status">Getting continuous updates of the Drone Status</h3>
<p>We want the drone to to send us statuses.<br>
This is handled by the <code>DjiFlutterApi</code> class.</p>
<h4 id="extend-your-widget-with-djiflutterapi">Extend your Widget with DjiFlutterApi</h4>
<p>First, extend your Widget with DjiFlutterApi, define the drone properties, and override your initState() method with the <code>_initDroneState()</code> and <code>DjiFlutterApi.setup()</code> methods per your needs.</p>
<pre class="language-dart"><code>class _ExampleWidgetState extends State&lt;ExampleWidget&gt;
    implements DjiFlutterApi {
  String _platformVersion = 'Unknown';
  String _droneStatus = 'Disconnected';
  String _droneBatteryPercent = '0';
  String _droneAltitude = '0.0';
  String _droneLatitude = '0.0';
  String _droneLongitude = '0.0';
  String _droneSpeed = '0.0';
  String _droneRoll = '0.0';
  String _dronePitch = '0.0';
  String _droneYaw = '0.0';

  FlightLocation? droneHomeLocation;

  @override
  void initState() {
    super.initState();

    DjiFlutterApi.setup(this);

    ...
  }
  ...
</code></pre>
<h4 id="setstatus">SetStatus</h4>
<p>Once we defined our private properties that we wish to get from the Drone, let's override the SetStatus method.<br>
<strong>The SetStatus method is triggered by the native host side of the plugin whenever the Drone status is changed.</strong></p>
<pre class="language-dart"><code>@override
void setStatus(Drone drone) async {
  setState(() {
    _droneStatus = drone.status ?? 'Disconnected';
    _droneAltitude = drone.altitude?.toStringAsFixed(2) ?? '0.0';
    _droneBatteryPercent = drone.batteryPercent?.toStringAsFixed(0) ?? '0';
    _droneLatitude = drone.latitude?.toStringAsFixed(7) ?? '0.0';
    _droneLongitude = drone.longitude?.toStringAsFixed(7) ?? '0.0';
    _droneSpeed = drone.speed?.toStringAsFixed(2) ?? '0.0';
    _droneRoll = drone.roll?.toStringAsFixed(3) ?? '0.0';
    _dronePitch = drone.pitch?.toStringAsFixed(3) ?? '0.0';
    _droneYaw = drone.yaw?.toStringAsFixed(3) ?? '0.0';
  });

  // Setting the inital drone location as the home location of the drone.
  if (droneHomeLocation == null &amp;&amp;
      drone.latitude != null &amp;&amp;
      drone.longitude != null &amp;&amp;
      drone.altitude != null) {
    droneHomeLocation = FlightLocation(
        latitude: drone.latitude!,
        longitude: drone.longitude!,
        altitude: drone.altitude!);
  }
}
</code></pre>
<p>Note that as soon as we get the first status from the Drone - we set the <code>droneHomeLocation</code> property.
This is simply useful for other parts of the Example project.</p>
<h3 id="sending-commands-to-the-drone">Sending Commands to the Drone</h3>
<p>The <code>Dji</code> class provides us with methods to connect and operate the Drone.</p>
<h4 id="djiplatformversion">Dji.platformVersion</h4>
<p>The <code>Dji.platformVersion</code> gets the host (native platform) version (e.g. The iOS or Android version).</p>
<pre class="language-dart"><code>// Platform messages are asynchronous, so we initialize in an async method.
Future&lt;void&gt; _getPlatformVersion() async {
  String platformVersion;

  // Platform messages may fail, so we use a try/catch PlatformException.
  // We also handle the message potentially returning null.
  try {
    platformVersion = await Dji.platformVersion ?? 'Unknown platform version';
  } on PlatformException {
    platformVersion = 'Failed to get platform version.';
  }

  // If the widget was removed from the tree while the asynchronous platform
  // message was in flight, we want to discard the reply rather than calling
  // setState to update our non-existent appearance.
  if (!mounted) return;

  setState(() {
    _platformVersion = platformVersion;
  });
}
</code></pre>
<h4 id="djiregisterapp">Dji.registerApp</h4>
<p>The <code>Dji.registerApp</code> triggers the DJI SDK registration method.<br>
This is a required action, everytime we launch our app, and before we attempt to connect to the Drone.</p>
<pre class="language-dart"><code>Future&lt;void&gt; _registerApp() async {
  try {
    await Dji.registerApp;
    developer.log(
      'registerApp succeeded',
      name: kLogKindDjiFlutterPlugin,
    );
  } on PlatformException catch (e) {
    developer.log(
      'registerApp PlatformException Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  } catch (e) {
    developer.log(
      'registerApp Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  }
}
</code></pre>
<h4 id="djiconnectdrone">Dji.connectDrone</h4>
<p>The <code>Dji.connectDrone</code> method triggers the process of connecting to the Drone.</p>
<pre class="language-dart"><code>Future&lt;void&gt; _connectDrone() async {
  try {
    await Dji.connectDrone;
    developer.log(
      'connectDrone succeeded',
      name: kLogKindDjiFlutterPlugin,
    );
  } on PlatformException catch (e) {
    developer.log(
      'connectDrone PlatformException Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  } catch (e) {
    developer.log(
      'connectDrone Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  }
}
</code></pre>
<h4 id="djidisconnectdrone">Dji.disconnectDrone</h4>
<p>The <code>Dji.disconnectDrone</code> method triggers the process of disconnecting from the Drone.</p>
<pre class="language-dart"><code>Future&lt;void&gt; _disconnectDrone() async {
  try {
    await Dji.disconnectDrone;
    developer.log(
      'disconnectDrone succeeded',
      name: kLogKindDjiFlutterPlugin,
    );
  } on PlatformException catch (e) {
    developer.log(
      'disconnectDrone PlatformException Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  } catch (e) {
    developer.log(
      'disconnectDrone Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  }
}
</code></pre>
<h4 id="djidelegatedrone">Dji.delegateDrone</h4>
<p>The <code>Dji.delegateDrone</code> method triggers the "listeners" to the Drone's statuses.
Upon any change to the Drone status properties - the SetState() method is triggerred (on the Flutter side).</p>
<pre class="language-dart"><code>Future&lt;void&gt; _delegateDrone() async {
  try {
    await Dji.delegateDrone;
    developer.log(
      'delegateDrone succeeded',
      name: kLogKindDjiFlutterPlugin,
    );
  } on PlatformException catch (e) {
    developer.log(
      'delegateDrone PlatformException Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  } catch (e) {
    developer.log(
      'delegateDrone Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  }
}
</code></pre>
<h4 id="djitakeoff">Dji.takeOff</h4>
<p>The <code>Dji.takeOff</code> method commands the Drone to start take-off.</p>
<pre class="language-dart"><code>Future&lt;void&gt; _takeOff() async {
  try {
    await Dji.takeOff;
    developer.log(
      'Takeoff succeeded',
      name: kLogKindDjiFlutterPlugin,
    );
  } on PlatformException catch (e) {
    developer.log(
      'Takeoff PlatformException Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  } catch (e) {
    developer.log(
      'Takeoff Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  }
}
</code></pre>
<h4 id="djiland">Dji.land</h4>
<p>The <code>Dji.land</code> method commands the Drone to start landing.</p>
<pre class="language-dart"><code>Future&lt;void&gt; _land() async {
  try {
    await Dji.land;
    developer.log(
      'Land succeeded',
      name: kLogKindDjiFlutterPlugin,
    );
  } on PlatformException catch (e) {
    developer.log(
      'Land PlatformException Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  } catch (e) {
    developer.log(
      'Land Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  }
}
</code></pre>
<h3 id="djistart">Dji.start</h3>
<p>The <code>Dji.start</code> method receives a Flight Timeline object and commands the Drone to start executing it.</p>
<p>The <code>Flight</code> class defines the different flight properties (e.g. location, waypoint, etc.) and provides tools to convert from and to JSON.</p>
<p>In the example below, the we first validate that the <code>DroneHomeLocation</code> exists and then we define our Flight object, which includes several Flight Elements.</p>
<p>A Flight Element has several types:</p>
<ul>
<li>takeOff</li>
<li>land</li>
<li>waypointMission</li>
<li>singleShootPhoto</li>
<li>startRecordVideo</li>
<li>stopRecordVideo</li>
</ul>
<p>The <code>waypointMission</code> consists of a list of waypoints.
Each waypoint can be defined in two ways: <code>location</code> or <code>vector</code>.</p>
<p><strong>Location</strong> defines a waypoint by Latitude, Longitude and Altitude.</p>
<p><strong>Vector</strong> defines a waypoint in relation to the "point of interest".
It's defined by 3 properties as follows:</p>
<ul>
<li><code>distanceFromPointOfInterest</code>
<ul>
<li>The distance in meters between the "point of interest" and the Drone.</li>
</ul>
</li>
<li><code>headingRelativeToPointOfInterest</code>
<ul>
<li>If you imagine a line between the "point of interest" (e.g. where you stand) and the Drone's Home Location - this is heading "0".</li>
<li>So the value of <code>headingRelativeToPointOfInterest</code> is the angle between heading "0" and where you want the Drone to be.</li>
<li>A positive heading angle is to your right. While a negative angle is to your left.</li>
</ul>
</li>
<li><code>destinationAltitude</code>
<ul>
<li>This is the Drone's altitude at the waypoint.</li>
</ul>
</li>
</ul>
<p><strong>Explanation by example:</strong>
Imagine you are the "point of interest", holding a "laser pointer".<br>
Everything is relative to the "line" between you and the Drone.<br>
If you point the laser to the Drone itself - that's "heading 0".<br>
If you want the first waypoint to be 30 degrees to your right, at a distance of 100 meters and altitude of 10 meters, you should set:</p>
<pre class="language-dart"><code>'vector': {
  'distanceFromPointOfInterest': 100,
  'headingRelativeToPointOfInterest': 30,
  'destinationAltitude': 10,
},
</code></pre>
<p>A full example showing how to use the Flight object and use the <code>Dji.start</code> method:</p>
<pre class="language-dart"><code>Future&lt;void&gt; _start() async {
  try {
    droneHomeLocation = FlightLocation(
        latitude: 32.2181125, longitude: 34.8674920, altitude: 0);

    if (droneHomeLocation == null) {
      developer.log(
          'No drone home location exist - unable to start the flight',
          name: kLogKindDjiFlutterPlugin);
      return;
    }

    Flight flight = Flight.fromJson({
      'timeline': [
        {
          'type': 'takeOff',
        },
        {
          'type': 'startRecordVideo',
        },
        {
          'type': 'waypointMission',
          // For example purposes, we set our Point of Interest a few meters away, relative to the Drone's Home Location
          'pointOfInterest': {
            'latitude': droneHomeLocation!.latitude + (5 * 0.00000899322),
            'longitude': droneHomeLocation!.longitude + (5 * 0.00000899322),
            'altitude': droneHomeLocation!.altitude,
          },
          'maxFlightSpeed':
              15.0, // Max Flight Speed is 15.0. If you enter a higher value - the waypoint mission won't start due to DJI limits.
          'autoFlightSpeed': 10.0,
          'finishedAction': 'noAction',
          'headingMode': 'towardPointOfInterest',
          'flightPathMode': 'curved',
          'rotateGimbalPitch': true,
          'exitMissionOnRCSignalLost': true,
          'waypoints': [
            {
              // 'location': {
              //   'latitude': 32.2181125,
              //   'longitude': 34.8674920,
              //   'altitude': 20.0,
              // },
              'vector': {
                'distanceFromPointOfInterest': 20,
                'headingRelativeToPointOfInterest': 45,
                'destinationAltitude': 5,
              },
              //'heading': 0,
              'cornerRadiusInMeters': 5,
              'turnMode': 'clockwise',
              // 'gimbalPitch': 0,
            },
            {
              // 'location': {
              //   'latitude': 32.2181125,
              //   'longitude': 34.8674920,
              //   'altitude': 5.0,
              // },
              'vector': {
                'distanceFromPointOfInterest': 10,
                'headingRelativeToPointOfInterest': -45,
                'destinationAltitude': 3,
              },
              //'heading': 0,
              'cornerRadiusInMeters': 5,
              'turnMode': 'clockwise',
              // 'gimbalPitch': 0,
            },
          ],
        },
        {
          'type': 'stopRecordVideo',
        },
        {
          'type': 'singleShootPhoto',
        },
        {
          'type': 'land',
        },
      ],
    });

    // Converting any vector definitions in waypoint-mission to locations
    for (dynamic element in flight.timeline) {
      if (element.type == FlightElementType.waypointMission) {
        CoordinatesConvertion
            .convertWaypointMissionVectorsToLocationsWithGimbalPitch(
                flightElementWaypointMission: element,
                droneHomeLocation: droneHomeLocation!);
      }
    }

    developer.log(
      'Flight Object: ${jsonEncode(flight)}',
      name: kLogKindDjiFlutterPlugin,
    );

    await Dji.start(flight: flight);
    developer.log(
      'Start Flight succeeded',
      name: kLogKindDjiFlutterPlugin,
    );
  } on PlatformException catch (e) {
    developer.log(
      'Start Flight PlatformException Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  } catch (e) {
    developer.log(
      'Start Flight Error',
      error: e,
      name: kLogKindDjiFlutterPlugin,
    );
  }
}
</code></pre>
<h5 id="notes">Notes</h5>
<ul>
<li>The waypoint-mission maxFlightSpeed can get a maximum value of 15.0. If you enter a higher value - the waypoint mission won't start due to DJI limits.</li>
<li>If you don't specify the <code>gimbalPitch</code>, the Flutter DJI Plugin will automatically calculate the Gimbal (Camera) angle to point to the Point of Interest.</li>
</ul>
<h2 id="tech-notes">TECH NOTES</h2>
<h3 id="plugin-creation-notes">Plugin Creation Notes</h3>
<p>This project was created by the Flutter plugin template using:</p>
<pre class="language-dart"><code>flutter create --org cloud.dragonx.plugin.flutter --template=plugin --platforms=ios -i swift dji
</code></pre>
<p>Android was added later on using:</p>
<pre class="language-dart"><code>flutter create --org cloud.dragonx.plugin.flutter --template=plugin --platforms=android .
</code></pre>
<p>Note: The folder name is "dji", just like we specified in the original flutter create command for iOS (otherwise it will cause different package names and class paths).
Also, when not specifying "-a java" - the Android project is Kotlin.
We're using iOS Swift and Android Kotlin (The Android project is Kotlin, although the DJI SDK is in Java).</p>
<p><code> ! </code> Important Note
Make sure you <code>cd example</code> and run <code>flutter build ios --no-codesign</code> before starting to change anything in Xcode or Flutter.
Otherwise, the plugin might not get built properly later on (I don't know why though).</p>
<h3 id="pigeon">Pigeon</h3>
<p>This plugin uses Pigeon:
<a href="https://pub.dev/packages/pigeon">https://pub.dev/packages/pigeon</a></p>
<p>To re-generate the Pigeon interfaces, execute:
flutter pub run pigeon <br>
--input pigeons/messages.dart <br>
--dart_out lib/messages.dart <br>
--objc_header_out ios/Classes/messages.h <br>
--objc_source_out ios/Classes/messages.m <br>
--objc_prefix FLT <br>
--java_out android/src/main/java/cloud/dragonx/plugin/flutter/dji/Messages.java <br>
--java_package "cloud.dragonx.plugin.flutter.dji"</p>
<h4 id="pigeon-swift-example">Pigeon Swift Example</h4>
<p><a href="https://github.com/DJI-Mobile-SDK-Tutorials/iOS-ImportAndActivateSDKInXcode-Swift">https://github.com/DJI-Mobile-SDK-Tutorials/iOS-ImportAndActivateSDKInXcode-Swift</a></p>
<h4 id="pigeon-android-kotlin-example">Pigeon Android Kotlin Example</h4>
<p><a href="https://github.com/gaaclarke/pigeon_plugin_example">https://github.com/gaaclarke/pigeon_plugin_example</a></p>
<p>Example how to use FlutterAPI (trigger a function from the native platform side):
<a href="https://github.com/glassmonkey/flutter_wifi/blob/master/android/app/src/main/kotlin/nagano/shunsuke/flutter_wifi_sample/WifiApi.kt">https://github.com/glassmonkey/flutter_wifi/blob/master/android/app/src/main/kotlin/nagano/shunsuke/flutter_wifi_sample/WifiApi.kt</a></p>
<h3 id="notes-in-regards-to-dji-sdk">Notes in regards to DJI SDK</h3>
<ul>
<li>Decided not to implement the "Bridge App" support, because turned out that - for debugging / development purposes - it is much easier to simply connect to the drone's Wifi, and let it connect using it (instead of using the Remote Controller).</li>
</ul>
<p><code> ! </code> Important Note
A bug in DJI's SDK in regards to Wifi Connection:
If you're developing / debugging, and your phone is connected to the Drone's Wifi - it means your mobile device does NOT have any internet connection.
Therefore, the Registration won't work.
However, due to a bug in the SDK - the appRegisteredWithError() responds with a "success", although it actually fails.</p>
<p>The solution is to first make sure you're disconnected from the Drone's Wifi - and let your App perform the Registration successfully.
And only after it has been registered - connect your mobile device to the Drone's Wifi, and execute the startConnectionToProduct()</p>
<p>Hint was taken from this issue on Github:
<a href="https://github.com/dji-sdk/Mobile-SDK-Android/issues/232">https://github.com/dji-sdk/Mobile-SDK-Android/issues/232</a></p>
<p><code> ! </code> Important Note
Before using any DJI SDK methods - you must execute:</p>
<pre class="language-dart"><code>Helper.install(this)
</code></pre>
<p>Usually this should be placed in your main application .kt file:
For example:</p>
<pre class="language-dart"><code>public class MyApplication : Application() {
    override fun attachBaseContext(paramContext: Context?) {
        super.attachBaseContext(paramContext)
        Helper.install(this)
    }
}
</code></pre>
<h3 id="dji-references">DJI References</h3>
<p>Useful tutorial: <a href="https://www.tooploox.com/blog/automated-drone-missions-on-ios">https://www.tooploox.com/blog/automated-drone-missions-on-ios</a></p>
<h3 id="debugging-android-over-wifi">Debugging Android over Wifi</h3>
<p>Find your device IP Address through the Android &gt; Settings &gt; wifi.
Connect it via USB cable and then run the following from your Desktop terminal:</p>
<pre class="language-dart"><code>adb tcpip 4455
</code></pre>
<p>Then disconnect the USB cable, and run the following:</p>
<pre class="language-dart"><code>adb connect {{your-android-ip}}:4455
</code></pre>
<h3 id="a-tip-in-regards-to-package-names">A Tip in regards to Package Names</h3>
<p>Due to inconsistencies between Google Play and Apple Appstore, there are differences in the "rules" that define what is a valid package-name.
For example, the "-" character cannot be used for Android, but is valid for iOS.
And with underscore there are issue when integrating with various Microsoft services (such as Microsoft Single Sign On).
So our tip here is to use package names without "-" or underscore, and that's why in the above example we used <code>djiExample</code> instead of <code>dji_example</code> or <code>dji-example</code>.</p>
</section>


      <section class="summary">
          <h2>Libraries</h2>
        <dl>
          <dt id="constants">
  <span class="name"><a href="constants/constants-library.html">constants</a></span> 

</dt>
<dd> 
</dd>

          <dt id="dji">
  <span class="name"><a href="dji/dji-library.html">dji</a></span> 

</dt>
<dd> 
</dd>

          <dt id="flight">
  <span class="name"><a href="flight/flight-library.html">flight</a></span> 

</dt>
<dd>Note:
Did not want to use any packages, for minimal dependencies, and therefore instead of using json_serialization package or string_to_enum, manually implemented the convertion from Enum to String, inspired by the enum_to_string package.
Enum to String: <a href="https://pub.dev/packages/enum_to_string">https://pub.dev/packages/enum_to_string</a>
JSON Serializable: <a href="https://pub.dev/packages/json_serializable">https://pub.dev/packages/json_serializable</a> <a href="flight/flight-library.html">[...]</a>
</dd>

          <dt id="messages">
  <span class="name"><a href="messages/messages-library.html">messages</a></span> 

</dt>
<dd> 
</dd>

        </dl>
      </section>

  </div> <!-- /.main-content -->

  <div id="dartdoc-sidebar-left" class="sidebar sidebar-offcanvas-left">
    <header id="header-search-sidebar" class="hidden-l">
  <form class="search-sidebar" role="search">
    <input type="text" id="search-sidebar" autocomplete="off" disabled class="form-control typeahead" placeholder="Loading search...">
  </form>
</header>

<ol class="breadcrumbs gt-separated dark hidden-l" id="sidebar-nav">
  <li><a href="https://dragonx.cloud/">dji package</a></li>
</ol>


    <h5 class="hidden-xs"><span class="package-name">dji</span> <span class="package-kind">package</span></h5>
    <ol>
      <li class="section-title">Libraries</li>
      <li><a href="constants/constants-library.html">constants</a></li>
      <li><a href="dji/dji-library.html">dji</a></li>
      <li><a href="flight/flight-library.html">flight</a></li>
      <li><a href="messages/messages-library.html">messages</a></li>
</ol>

  </div>

  <div id="dartdoc-sidebar-right" class="sidebar sidebar-offcanvas-right">
  </div>

</main>

<footer>
  <span class="no-break">
    dji
      1.0.0-dev.4
  </span>

  
</footer>



<script src="static-assets/highlight.pack.js?v1"></script>
<script src="static-assets/script.js?v1"></script>



</body>

</html>

